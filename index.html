<!doctype html>
<html>
    <head>
        <title>Marvel</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <style>
            body {
                padding-top: 24px;
            }
            .hero-card {
                margin-top: 12px;
                padding: 6px;
                border: 1px solid #ababab;
            }
            .img-200 {
                height: 200px;
                width: 200px;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>Marvel Characters</h1>
            <div class="d-flex justify-content-between">
                <div>
                    <button type="button" class="btn btn-dark">Prev</button>
                </div>
                <div>...................</div>
                <div>
                    <button type="buton" class="btn btn-dark">Next</button>
                </div>
            </div>
        </div>
        <div id="content" class="container"></div>
        <script>
            let httpRequest;
            let requestUrl = 'https://gateway.marvel.com:443/v1/public/characters?series=354&apikey=622acfc296433d3d5fdbe221baa6da38';
            function makeRequest() {
                httpRequest = new XMLHttpRequest();
                if (!httpRequest) {
                    alert('Giving up :( Cannot create an XMLHTTP instance');
                    return false;
                }
                httpRequest.onreadystatechange = readResponse;
                httpRequest.open('GET', requestUrl);
                httpRequest.send();
            }

            function readResponse() {
                if (httpRequest.readyState === XMLHttpRequest.DONE) {
                    if (httpRequest.status === 200) {
                        displayResponse(httpRequest.response);
                    } else {
                        alert('There was a problem with the request.');
                    }
                }
            }

            function displayResponse(response) {
                let content = document.getElementById("content");
                let res = JSON.parse(response);
                console.log(res);
                let results = res.data.results;
                let heroesList = createElementOn(content, "div", "heroes");
                for (let hero of results) {
                    let heroText = '' + hero.id + ': ' + hero.name 
                    let heroElement = createElementOn(heroesList, "div", hero.id, heroText);
                    heroElement.classList.add("hero-card");
                    heroElement.innerHTML = `
                        <div class="media">
                            <img src="${hero.thumbnail.path + "." + hero.thumbnail.extension}" class="img-thumbnail img-200 align-self-center mr-3" alt=${hero.name}>
                            <div class="media-body">
                                <h5 class="mt-0">${hero.name}</h5>
                                <p>${hero.description}</p>
                            </div>
                        </div>`;
                }
            }

            function createElementOn(target, tag, id, text) {
                let element = document.createElement(tag);
                if (text) {
                    let newContent = document.createTextNode(text);
                    element.appendChild(newContent);
                }
                if (id) {
                    element.id = id;
                }
                target.appendChild(element);
                return element;
            }

            makeRequest();
        </script>
    </body>
</html>